{"source":"webpackJsonp([13],{1307:function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(262),l=r.n(n),a=r(265),s=r.n(a),m=r(1390),f=r(1391);function v(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}t.default={namespace:\"project-cameras\",state:{pageSize:20,list:[],page:1,total:void 0,keyword:void 0,loading:!1,selected:void 0,storageQuota:void 0,info:void 0},subscriptions:{setup:function(e){var a=e.dispatch;return e.history.listen(function(e){var t=e.pathname,r=t.match(/^\\/p\\/([\\w-]+)\\/events$/);if(r)return a({type:\"init\",payload:{projectName:r[1]}});var n=t.match(/^\\/p\\/([\\w-]+)\\/events\\/([\\w-]+)\\//);return n?a({type:\"getEventInfo\",payload:{projectName:n[1],eventId:n[2]}}):void 0})}},effects:{init:l.a.mark(function e(t,r){var n,a,o,u=t.payload,c=r.put;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.a.parseUrl(window.location.href),a=n.query,o=parseInt(a.page||1,10),e.next=4,c({type:\"save\",payload:{keyword:a.keyword,page:o}});case 4:return e.next=6,c({type:\"save\",payload:{list:[],total:void 0}});case 6:return e.next=8,c({type:\"getStorageQuota\",payload:u});case 8:return e.next=10,c({type:\"load\",payload:u});case 10:case\"end\":return e.stop()}},e,this)}),getStorageQuota:l.a.mark(function e(t,r){var n,a,o,u,c=t.payload,s=r.call,p=r.put,i=r.select;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(function(e){return e.events});case 2:if(n=e.sent,(a=n.storageQuota)&&a.project_name===c.projectName){e.next=13;break}return e.next=7,p({type:\"save\",payload:{storageQuota:void 0}});case 7:return e.next=9,s(f.a.getStorageQuota,c);case 9:return o=e.sent,u=o.data,e.next=13,p({type:\"save\",payload:{storageQuota:u||null}});case 13:case\"end\":return e.stop()}},e,this)}),load:l.a.mark(function e(t,r){t.payload;var n,a,o,u,c,s,p,i,f=r.call,v=r.put,d=r.select;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(function(e){return e.events});case 2:if(n=e.sent,a=n.page,o=n.pageSize,u=n.keyword,!n.loading){e.next=9;break}return e.abrupt(\"return\");case 9:return e.next=11,v({type:\"save\",payload:{loading:!0}});case 11:return e.next=13,d(function(e){return e.client});case 13:return c=e.sent,s=c.selected,e.next=17,f(m.a.getEvents,{projectName:s,keyword:u,start:(a-1)*o,limit:o});case 17:return p=e.sent,i=p.data,p.err,e.next=22,v({type:\"save\",payload:{loading:!1}});case 22:if(!i){e.next=26;break}return e.next=26,v({type:\"save\",payload:{list:i.list,total:i.total}});case 26:case\"end\":return e.stop()}},e,this)}),getEventInfo:l.a.mark(function e(t,r){var n,a,o=t.payload,u=r.put,c=r.select;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(function(e){return e.events});case 2:if(n=e.sent,!(a=n.info)||o.eventId!==a.event_id){e.next=6;break}return e.abrupt(\"return\");case 6:return e.next=8,u({type:\"refreshEventInfo\",payload:o});case 8:case\"end\":return e.stop()}},e,this)}),refreshEventInfo:l.a.mark(function e(t,r){var n,a,o=t.payload,u=r.call,c=r.put;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({type:\"save\",payload:{info:void 0}});case 2:return e.next=4,u(m.a.getEvent,o);case 4:return n=e.sent,a=n.data,e.next=8,c({type:\"save\",payload:{info:a||null}});case 8:case\"end\":return e.stop()}},e,this)}),updateInfo:l.a.mark(function e(t,r){var n,a,o,u,c,s=t.payload,p=r.put,i=r.select;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(function(e){return e.events});case 2:if(n=e.sent,a=n.info,o=s.eventId,u=s.projectName,c=v(s,[\"eventId\",\"projectName\"]),!a||u!==a.project_name||o!==a.event_id){e.next=8;break}return e.next=8,p({type:\"save\",payload:{info:Object.assign({},a,c)}});case 8:case\"end\":return e.stop()}},e,this)})},reducers:{save:function(e,t){return Object.assign({},e,t.payload)}}}},1390:function(e,t,r){\"use strict\";var n=r(262),o=r.n(n),a=r(507);function u(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function c(e){return function(){var c=e.apply(this,arguments);return new Promise(function(o,u){return function t(e,r){try{var n=c[e](r),a=n.value}catch(e){return void u(e)}if(!n.done)return Promise.resolve(a).then(function(e){t(\"next\",e)},function(e){t(\"throw\",e)});o(a)}(\"next\")})}}var s,p,i,f,v,d,l,m,h,y,j,w=function(){return Object(a.a)(\"/projects/:projectName/record/events/:eventId/:type\")},x=function(){return Object(a.a)(\"/projects/:projectName/record/:resourceType/:resourceId/:action\")};t.a={getEvents:(j=c(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",w().get(t));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return j.apply(this,arguments)}),getEvent:(y=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",w().get({projectName:r,eventId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)}),updateEventInfo:(h=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId,a=u(t,[\"projectName\",\"eventId\"]);return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",w().put({projectName:r,eventId:n},a));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)}),createVodSession:(m=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",w().post({projectName:r,eventId:n,type:\"vod_sessions\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)}),removeEvent:(l=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",w().remove({projectName:r,eventId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)}),createMultiUploadSession:(d=c(o.a.mark(function e(t){var r=t.projectName,n=t.fileName,a=t.fileType;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().post({projectName:r,resourceType:\"event_multipart_uploads\"},{file_name:n,mime:a}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)}),getMultiUploadSessionToken:(v=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().post({projectName:r,resourceType:\"event_multipart_uploads\",resourceId:n,action:\"token\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)}),updateMultiUploadSession:(f=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().post({projectName:r,resourceType:\"event_multipart_uploads\",resourceId:n,action:\"done\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),delMultiUploadSession:(i=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().remove({projectName:r,resourceType:\"event_multipart_uploads\",resourceId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)}),mergeEvents:(p=c(o.a.mark(function e(t){var r=t.projectName,n=u(t,[\"projectName\"]);return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().post({projectName:r,resourceType:\"merge_events\"},n));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)}),getTsUrl:(s=c(o.a.mark(function e(t){var r=t.projectName,n=t.eventId;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",x().get({projectName:r,resourceType:\"events\",resourceId:n,action:\"ts_url\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})}},1391:function(e,t,r){\"use strict\";var n=r(262),o=r.n(n),a=r(507);function u(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function c(e){return function(){var c=e.apply(this,arguments);return new Promise(function(o,u){return function t(e,r){try{var n=c[e](r),a=n.value}catch(e){return void u(e)}if(!n.done)return Promise.resolve(a).then(function(e){t(\"next\",e)},function(e){t(\"throw\",e)});o(a)}(\"next\")})}}var s,p,i,f,v,d,l,m,h,y,j,w,x,g,N,b,k,I=function(){return Object(a.a)(\"/projects/:projectName/:resourcetype/:resourceId/:subType/:subId\")};t.a={addVirtualCamera:(k=c(o.a.mark(function e(t){var r=t.projectName,n=u(t,[\"projectName\"]);return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().post({projectName:r,resourcetype:\"add_virtual_camera\"},n));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return k.apply(this,arguments)}),getStorageQuota:(b=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"storage_quota\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)}),getProjects:(N=c(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get(t));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return N.apply(this,arguments)}),getProjectInfo:(g=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)}),updateProjectInfo:(x=c(o.a.mark(function e(t){var r=t.projectName,n=u(t,[\"projectName\"]);return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().put({projectName:r},n));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)}),getAccount:(w=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"account\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)}),getQuota:(j=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"quota\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return j.apply(this,arguments)}),getOnlineSchoolConfig:(y=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"online_school\",resourceId:\"config\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)}),getWechatMerchant:(h=c(o.a.mark(function e(t){var r=t.projectName;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"wechat_merchant\"}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)}),getProjectUsers:(m=c(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get(Object.assign({},t,{resourcetype:\"users\"})));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)}),getProjectUserInfo:(l=c(o.a.mark(function e(t){var r=t.projectName,n=t.username;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"users\",resourceId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)}),addProjectUser:(d=c(o.a.mark(function e(t){var r=t.projectName,n=t.username,a=t.role;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().post({projectName:r,resourcetype:\"users\"},{username:n,role:a}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)}),removeProjectUser:(v=c(o.a.mark(function e(t){var r=t.projectName,n=t.username;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().remove({projectName:r,resourcetype:\"users\",resourceId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)}),getProjectUserRoles:(f=c(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get(Object.assign({},t,{resourcetype:\"user_roles\"})));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),getProjectUserRole:(i=c(o.a.mark(function e(t){var r=t.projectName,n=t.username;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get({projectName:r,resourcetype:\"user_roles\",resourceId:n}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)}),updateProjectUserRole:(p=c(o.a.mark(function e(t){var r=t.projectName,n=t.username,a=t.role;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().put({projectName:r,resourcetype:\"user_roles\",resourceId:n},{role:a}));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)}),getProjectDevices:(s=c(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",I().get(Object.assign({},t,{resourcetype:\"devices\"})));case 1:case\"end\":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})}}});"}