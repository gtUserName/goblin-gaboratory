{"version":3,"sources":["models/client/project.js"],"names":["__webpack_exports__","namespace","state","roleInfo","undefined","loading","subscriptions","setup","_ref","dispatch","history","listen","_ref2","match","pathname","type","payload","projectName","effects","reset","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","a","mark","_ref3","_ref4","call","put","wrap","_context","prev","next","stop","this","init","_ref5","_ref6","_ref7","select","_context2","project","sent","project_name","abrupt","getRoleInfo","_ref8","_ref9","_ref10","_ref11","userInfo","_ref12","data","errMsg","_context3","client","__WEBPACK_IMPORTED_MODULE_1__services_user__","getUserRole","username","response","status","reducers","save","action","Object","assign"],"mappings":"kIAGAA,EAAA,SAEEC,UAAW,UAEXC,OACEC,cAAUC,EACVC,SAAS,GAGXC,eACEC,MADa,SAAAC,GACgB,IAArBC,EAAqBD,EAArBC,SAEN,OAF2BD,EAAXE,QAEDC,OAAO,SAAAC,GAAkB,IAChCC,EADgCD,EAAfE,SACAD,MAAM,uBACzBA,GACFJ,GAAWM,KAAM,OAAQC,SAAWC,YAAaJ,EAAM,UAM/DK,SACGC,MADMC,EAAAC,EAAAC,KAAA,SAAAH,EAAAI,EAAAC,GAAAD,EACEP,QADFQ,EACeC,KADf,IACqBC,EADrBF,EACqBE,IADrB,OAAAN,EAAAC,EAAAM,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAECJ,GACJX,KAAM,OACNC,SACEb,cAAUC,EACVC,SAAS,KANR,wBAAAuB,EAAAG,SAAAZ,EAAAa,QAUNC,KAVMb,EAAAC,EAAAC,KAAA,SAAAW,EAAAC,EAAAC,GAAA,IAAAC,EAAAjC,EAUCa,EAVDkB,EAUClB,QAAmBU,GAVpBS,EAUcV,KAVdU,EAUoBT,KAAKW,EAVzBF,EAUyBE,OAVzB,OAAAjB,EAAAC,EAAAM,KAAA,SAAAW,GAAA,cAAAA,EAAAT,KAAAS,EAAAR,MAAA,cAAAQ,EAAAR,KAAA,EAYsBO,EAAO,SAAAnC,GAAA,OAASA,EAAMqC,UAZ5C,UAAAH,EAAAE,EAAAE,OAYGrC,EAZHiC,EAYGjC,WACQA,EAASsC,eAAiBzB,EAAQC,YAb7C,CAAAqB,EAAAR,KAAA,eAAAQ,EAAAI,OAAA,wBAAAJ,EAAAR,KAAA,EAgBCJ,GAAMX,KAAM,cAAeC,YAhB5B,wBAAAsB,EAAAP,SAAAE,EAAAD,QAkBNW,YAlBMvB,EAAAC,EAAAC,KAAA,SAAAqB,EAAAC,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAkBQnC,EAlBR4B,EAkBQ5B,QAAaS,EAlBrBoB,EAkBqBpB,KAAMC,EAlB3BmB,EAkB2BnB,IAAKW,EAlBhCQ,EAkBgCR,OAlBhC,OAAAjB,EAAAC,EAAAM,KAAA,SAAAyB,GAAA,cAAAA,EAAAvB,KAAAuB,EAAAtB,MAAA,cAAAsB,EAAAtB,KAAA,EAmBqBO,EAAO,SAAAnC,GAAA,OAASA,EAAMG,UAnB3C,UAAAyC,EAAAM,EAAAZ,MAAAM,EAmBGzC,QAnBH,CAAA+C,EAAAtB,KAAA,eAAAsB,EAAAV,OAAA,wBAAAU,EAAAtB,KAAA,EAuBCJ,GAAMX,KAAM,OAAQC,SAAWb,cAAUC,EAAWC,SAAS,KAvB9D,cAAA+C,EAAAtB,KAAA,GAwBsBO,EAAO,SAAAnC,GAAA,OAASA,EAAMmD,SAxB5C,eAAAN,EAAAK,EAAAZ,KAwBGQ,EAxBHD,EAwBGC,SAxBHI,EAAAtB,KAAA,GAyB0BL,EAAK6B,EAAA,EAAYC,aAAeC,SAAUR,EAASQ,SAAUvC,YAAaD,EAAQC,cAzB5G,eAAAgC,EAAAG,EAAAZ,KAyBGU,EAzBHD,EAyBGC,KAAMC,EAzBTF,EAyBSE,OAzBTC,EAAAtB,KAAA,GA0BCJ,GAAMX,KAAM,OAAQC,SAAWX,SAAS,EAAOF,SAAU+C,GAAQ,QA1BlE,YA2BDC,IAAUA,EAAOM,UAAY,MAAQN,EAAOM,SAASC,OA3BpD,CAAAN,EAAAtB,KAAA,gBAAAsB,EAAAtB,KAAA,GA4BGJ,GAAMX,KAAM,2BA5Bf,yBAAAqC,EAAArB,SAAAY,EAAAX,SAiCT2B,UACEC,KADQ,SACH1D,EAAO2D,GACV,OAAAC,OAAAC,UAAY7D,EAAU2D,EAAO7C","file":"static/js/0.c6b832a7.chunk.js","sourcesContent":["// import { delay } from '../../utils';\r\nimport userService from '../../services/user';\r\n\r\nexport default {\r\n\r\n  namespace: 'project',\r\n\r\n  state: {\r\n    roleInfo: undefined,\r\n    loading: false,\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ dispatch, history }) {  // eslint-disable-line\r\n      // dispatch({ type: 'init' });\r\n      return history.listen(({ pathname }) => {\r\n        const match = pathname.match(/\\/p\\/([^/]+)(\\/.*)?/);\r\n        if (match) {\r\n          dispatch({ type: 'init', payload: { projectName: match[1] } });\r\n        }\r\n      });\r\n    },\r\n  },\r\n\r\n  effects: {\r\n    *reset({ payload }, { call, put }) {  // eslint-disable-line\r\n      yield put({\r\n        type: 'save',\r\n        payload: {\r\n          roleInfo: undefined,\r\n          loading: false,\r\n        },\r\n      });\r\n    },\r\n    *init({ payload }, { call, put, select }) {  // eslint-disable-line\r\n      // debugger;\r\n      const { roleInfo } = yield select(state => state.project);\r\n      if (roleInfo && roleInfo.project_name === payload.projectName) {\r\n        return;\r\n      }\r\n      yield put({ type: 'getRoleInfo', payload });\r\n    },\r\n    *getRoleInfo({ payload }, { call, put, select }) {  // eslint-disable-line\r\n      const { loading } = yield select(state => state.loading);\r\n      if (loading) {\r\n        return;\r\n      }\r\n      yield put({ type: 'save', payload: { roleInfo: undefined, loading: true } });\r\n      const { userInfo } = yield select(state => state.client);\r\n      const { data, errMsg } = yield call(userService.getUserRole, { username: userInfo.username, projectName: payload.projectName });\r\n      yield put({ type: 'save', payload: { loading: false, roleInfo: data || null } });\r\n      if (errMsg && errMsg.response && 404 === errMsg.response.status) {\r\n        yield put({ type: 'client/getUserResource' });\r\n      }\r\n    },\r\n  },\r\n\r\n  reducers: {\r\n    save(state, action) {\r\n      return { ...state, ...action.payload };\r\n    },\r\n  },\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/client/project.js"],"sourceRoot":""}