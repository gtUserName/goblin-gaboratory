{"version":3,"sources":["models/admin/projectDevices.js","services/project.js"],"names":["__webpack_exports__","namespace","state","pageSize","list","page","total","undefined","loading","subscriptions","setup","_ref","dispatch","history","listen","_ref2","pathname","search","match","type","payload","projectName","effects","init","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","a","mark","_ref3","_ref4","parsed","put","wrap","_context","prev","next","__WEBPACK_IMPORTED_MODULE_1_query_string___default","parse","parseInt","stop","this","load","_ref5","_ref6","_ref7","_ref8","data","errMsg","call","select","_context2","sent","abrupt","__WEBPACK_IMPORTED_MODULE_2__services_project__","getProjectDevices","start","limit","Object","__WEBPACK_IMPORTED_MODULE_3__utils__","reducers","save","action","assign","projects","__WEBPACK_IMPORTED_MODULE_1__utils_resource__","addVirtualCamera","_asyncToGenerator","_callee","_objectWithoutProperties","post","resourcetype","_x","apply","arguments","getStorageQuota","_callee2","get","_x2","getProjects","_callee3","params","_context3","_x3","getProjectInfo","_callee4","_context4","_x4","updateProjectInfo","_ref9","_callee5","_context5","_x5","getAccount","_ref11","_callee6","_ref10","_context6","_x6","getQuota","_ref13","_callee7","_ref12","_context7","_x7","getOnlineSchoolConfig","_ref15","_callee8","_ref14","_context8","resourceId","_x8","getWechatMerchant","_ref17","_callee9","_ref16","_context9","_x9","getProjectUsers","_ref18","_callee10","_context10","_x10","getProjectUserInfo","_ref20","_callee11","_ref19","username","_context11","_x11","addProjectUser","_ref22","_callee12","_ref21","role","_context12","_x12","removeProjectUser","_ref24","_callee13","_ref23","_context13","remove","_x13","getProjectUserRoles","_ref25","_callee14","_context14","_x14","getProjectUserRole","_ref27","_callee15","_ref26","_context15","_x15","updateProjectUserRole","_ref29","_callee16","_ref28","_context16","_x16","_ref30","_callee17","_context17","_x17"],"mappings":"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","file":"static/js/18.bb433c7b.chunk.js","sourcesContent":["// import { routerRedux } from 'dva/router';\nimport queryString from 'query-string';\nimport projectService from '../../services/project';\nimport { notifyRequestError } from '../../utils';\n\n\nexport default {\n  namespace: 'project-devices',\n  state: {\n    pageSize: 20,\n    list: [],\n    page: 1,\n    total: undefined,\n    loading: false,\n  },\n\n  subscriptions: {\n    setup({ dispatch, history }) {\n      return history.listen(({ pathname, search }) => {\n        const match = pathname.match(/^\\/projects\\/([\\w-]+)\\/devices$/);\n        if (match) {\n          return dispatch({ type: 'init', payload: { projectName: match[1], search } });\n        }\n      });\n    },\n  },\n\n  effects: {\n    *init({ payload }, { put }) {\n      const parsed = queryString.parse(payload.search);\n      const page = parseInt(parsed.page || 1, 10);\n      yield put({ type: 'save', payload: { page, list: [], total: undefined } });\n      yield put({ type: 'load', payload });\n    },\n    *load({ payload }, { call, put, select }) {\n      const { page, pageSize, loading } = yield select(state => state['project-users']);\n      if (loading) {\n        return;\n      }\n      yield put({ type: 'save', payload: { loading: true } });\n      const { data, errMsg } = yield call(projectService.getProjectDevices, {\n        start: (page - 1) * pageSize,\n        limit: pageSize,\n        projectName: payload.projectName,\n      });\n      yield put({ type: 'save', payload: { loading: false, list: (data && data.list) || null, total: (data && data.total) } });\n      if (errMsg) {\n        notifyRequestError(errMsg, '获取设备列表失败');\n      }\n    },\n  },\n\n  reducers: {\n    save(state, action) {\n      return { ...state, ...action.payload };\n    },\n  },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/admin/projectDevices.js","\r\nimport resource from '../utils/resource';\r\n\r\nconst projects = () => {\r\n  return resource('/projects/:projectName/:resourcetype/:resourceId/:subType/:subId');\r\n};\r\n// const storageQuota = () => {\r\n//   return resource('/projects/:projectName/storage_quota');\r\n// };\r\n\r\nexport default {\r\n  async addVirtualCamera({ projectName, ...data }) {\r\n    return projects().post({ projectName, resourcetype: 'add_virtual_camera' }, data);\r\n  },\r\n  async getStorageQuota({ projectName }) {\r\n    return projects().get({ projectName, resourcetype: 'storage_quota' });\r\n  },\r\n  async getProjects(params) {\r\n    return projects().get(params);\r\n  },\r\n  async getProjectInfo({ projectName }) {\r\n    return projects().get({ projectName });\r\n  },\r\n  async updateProjectInfo({ projectName, ...data }) {\r\n    return projects().put({ projectName }, data);\r\n  },\r\n  async getAccount({ projectName }) {\r\n    return projects().get({ projectName, resourcetype: 'account' });\r\n  },\r\n  async getQuota({ projectName }) {\r\n    return projects().get({ projectName, resourcetype: 'quota' });\r\n  },\r\n  async getOnlineSchoolConfig({ projectName }) {\r\n    return projects().get({ projectName, resourcetype: 'online_school', resourceId: 'config' });\r\n  },\r\n  async getWechatMerchant({ projectName }) {\r\n    return projects().get({ projectName, resourcetype: 'wechat_merchant' });\r\n  },\r\n  async getProjectUsers(params) {\r\n    return projects().get({ ...params, resourcetype: 'users' });\r\n  },\r\n  async getProjectUserInfo({ projectName, username }) {\r\n    return projects().get({ projectName, resourcetype: 'users', resourceId: username });\r\n  },\r\n  async addProjectUser({ projectName, username, role }) {\r\n    return projects().post({ projectName, resourcetype: 'users' }, { username, role });\r\n  },\r\n  async removeProjectUser({ projectName, username }) {\r\n    return projects().remove({ projectName, resourcetype: 'users', resourceId: username });\r\n  },\r\n  async getProjectUserRoles(params) {\r\n    return projects().get({ ...params, resourcetype: 'user_roles' });\r\n  },\r\n  async getProjectUserRole({ projectName, username }) {\r\n    return projects().get({ projectName, resourcetype: 'user_roles', resourceId: username });\r\n  },\r\n  async updateProjectUserRole({ projectName, username, role }) {\r\n    return projects().put({ projectName, resourcetype: 'user_roles', resourceId: username }, { role });\r\n  },\r\n  async getProjectDevices(params) {\r\n    return projects().get({ ...params, resourcetype: 'devices' });\r\n  },\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/project.js"],"sourceRoot":""}