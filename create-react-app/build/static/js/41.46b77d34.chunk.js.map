{"version":3,"sources":["routes/Client/Shows/Schedules.js","services/show.js"],"names":["columns","title","dataIndex","key","render","text","record","__WEBPACK_IMPORTED_MODULE_4_moment___default","start","format","end","Schedules","props","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","state","list","loading","__WEBPACK_IMPORTED_MODULE_1_react___default","a","PureComponent","load","setState","__WEBPACK_IMPORTED_MODULE_5__services_show__","getShowSchedules","projectName","match","params","name","length","limit","data","concat","total","createElement","__WEBPACK_IMPORTED_MODULE_3_antd__","bordered","dataSource","pagination","rowKey","uuid","propTypes","__WEBPACK_IMPORTED_MODULE_2_prop_types___default","object","__webpack_exports__","shows","__WEBPACK_IMPORTED_MODULE_1__utils_resource__","liveShowResource","getShows","_ref","_asyncToGenerator","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","mark","_callee","wrap","_context","prev","next","keyword","abrupt","get","stop","_x","apply","arguments","getShow","_ref3","_callee2","_ref2","showId","_context2","_x2","getShowTags","_ref5","_callee3","_ref4","_context3","type","_x3","getShowStatistic","_ref7","_callee4","_ref6","_context4","_x4","getLiveStatistics","_ref9","_callee5","_ref8","_context5","_x5","getShowRecords","_ref11","_callee6","_ref10","_context6","_x6","removeShowRecord","_ref13","_callee7","_ref12","eventId","_context7","remove","subId","_x7","addShowRecords","_ref15","_callee8","_ref14","events","_context8","post","_x8","_ref17","_callee9","_ref16","_context9","resourceType","_x9","getShowsByEvent","_ref19","_callee10","_ref18","_context10","resourceId","_x10","changeShowState","_ref21","_callee11","_ref20","op","_context11","_x11","updateShowInfo","_ref23","_callee12","_ref22","_objectWithoutProperties","_context12","put","_x12"],"mappings":"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","file":"static/js/41.46b77d34.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n// import { connect } from 'dva';\r\nimport { Card, Table } from 'antd';\r\nimport moment from 'moment';\r\n// import numeral from 'numeral';\r\n// import DescriptionList from 'ant-design-pro/lib/DescriptionList';\r\n// import { showState } from '../../../utils/filter';\r\nimport showServer from '../../../services/show';\r\n// import styles from './Records.less';\r\n\r\n\r\nconst columns = [{\r\n  title: '时间段',\r\n  dataIndex: 'start',\r\n  key: 'start',\r\n  render: (text, record) => {\r\n    return `${moment((record.start + 57600) * 1000).format('HH:mm')} - ${moment((record.end + 57600) * 1000).format('HH:mm')}`;\r\n  },\r\n}, {\r\n  title: '重复',\r\n  dataIndex: 'weekday_bits',\r\n  key: 'weekday_bits',\r\n  // render: weekday_bits => event.state,\r\n}, {\r\n  title: '状态',\r\n  dataIndex: 'state',\r\n  key: 'state',\r\n  // render: event => moment(event.start).format('YYYY-MM-DD HH:mm:ss'),\r\n}, {\r\n  title: '操作',\r\n  dataIndex: 'live_enabled',\r\n  key: 'live_enabled',\r\n  // render: event => numeral(event.duration / 1000).format('00:00:00'),\r\n}, {\r\n  title: 'action',\r\n  dataIndex: 'uuid',\r\n  key: 'uuid',\r\n  // render: event => event.size,\r\n}];\r\n\r\n\r\nclass Schedules extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      list: [],\r\n      loading: false,\r\n    };\r\n\r\n    // this.onLoad = this.onLoad.bind(this);\r\n    // this.onRefresh = this.onRefresh.bind(this);\r\n    // this.onSearch = this.onSearch.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    this.load();\r\n  }\r\n  async load() {\r\n    this.setState({ loading: true });\r\n    const { data } = await showServer.getShowSchedules({\r\n      projectName: this.props.match.params.name,\r\n      start: this.state.list.length,\r\n      limit: 100,\r\n    });\r\n    const list = data.list.concat(this.state.list);\r\n    this.setState({ loading: false, list });\r\n    if (list.length < data.total && 0 < data.list.length) {\r\n      this.load();\r\n    }\r\n  }\r\n  // onLoad() {\r\n  //   this.props.dispatch({ type: 'shows/load' });\r\n  // }\r\n  // onRefresh() {\r\n  //   this.props.dispatch({ type: 'shows/reload' });\r\n  // }\r\n  // onSearch(keyword) {\r\n  //   this.props.dispatch({ type: 'shows/search', payload: keyword });\r\n  // }\r\n  render() {\r\n    // const { info } = this.props;\r\n    // if (!info) {\r\n    //   return null;\r\n    // }\r\n\r\n    return (\r\n      <Card bordered={false}>\r\n        <Table\r\n          dataSource={this.state.list}\r\n          loading={this.state.loading}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={record => record.uuid}\r\n        />\r\n      </Card>\r\n    );\r\n  }\r\n}\r\n\r\nSchedules.propTypes = {\r\n  match: PropTypes.object,\r\n};\r\n\r\nexport default Schedules;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Client/Shows/Schedules.js","\r\n// import { resource } from '../utils';\r\nimport resource from '../utils/resource';\r\n\r\n\r\nconst shows = () => {\r\n  return resource('/projects/:projectName/live_shows/:showId/:type/:subId');\r\n};\r\n\r\n// const showSchedules = () => {\r\n//   return resource('/projects/:projectName/live_show_schedules/:scheduleId');\r\n// };\r\n\r\n\r\nconst liveShowResource = () => {\r\n  return resource('/projects/:projectName/live_show/:resourceType/:resourceId/live_shows');\r\n};\r\n\r\nexport default {\r\n  async getShows(params) {\r\n    const data = {\r\n      projectName: params.projectName,\r\n      start: params.start,\r\n      limit: params.limit,\r\n    };\r\n    if (('string' === typeof params.keyword) && '' !== params.keyword) {\r\n      data.keyword = params.keyword;\r\n    }\r\n    return shows().get(data);\r\n  },\r\n  async getShow({ projectName, showId }) {\r\n    return shows().get({ projectName, showId });\r\n  },\r\n  async getShowTags({ projectName, showId }) {\r\n    return shows().get({ projectName, showId, type: 'tags' });\r\n  },\r\n  async getShowStatistic({ projectName, showId }) {\r\n    return shows().get({ projectName, showId, type: 'statistic' });\r\n  },\r\n  async getLiveStatistics({ projectName, showId }) {\r\n    return shows().get({ projectName, showId, type: 'lives' });\r\n  },\r\n  async getShowRecords({ projectName, showId }) {\r\n    return shows().get({ projectName, showId, type: 'records' });\r\n  },\r\n  async removeShowRecord({ projectName, showId, eventId }) {\r\n    return shows().remove({ projectName, showId, type: 'records', subId: eventId });\r\n  },\r\n  async addShowRecords({ projectName, showId, events }) {\r\n    return shows().post({ projectName, showId, type: 'records' }, events);\r\n  },\r\n  async getShowSchedules({ projectName, start, limit }) {\r\n    return liveShowResource().get({ projectName, resourceType: 'live_show_schedules', start, limit });\r\n  },\r\n  async getShowsByEvent({ projectName, eventId }) {\r\n    return liveShowResource().get({ projectName, resourceType: 'events', resourceId: eventId });\r\n  },\r\n  async changeShowState({ projectName, showId, op }) {\r\n    return shows().post({ projectName, showId }, { op });\r\n  },\r\n  async updateShowInfo({ projectName, showId, ...data }) {\r\n    return shows().put({ projectName, showId }, data);\r\n  },\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/show.js"],"sourceRoot":""}